{% assign publications = include.publications %}
{% assign pinned_pubs = publications | where: "pinned", true | sort: "date" | reverse %}
{% assign non_pinned_selected_pubs = publications | where: "selected", true | where: "pinned", false | sort: "date" | reverse %}
{% assign all_pubs = pinned_pubs | concat: non_pinned_selected_pubs %}

<div class="my-3 p-0 bg-white shadow-sm rounded-sm">
    <h6 class="border-gray p-3 mb-0" style="font-weight: bold;">
        {% if include.title %}{{ include.title }}{% else %}<i class="fas fa-star"></i> Selected Recent Publications{% endif %} 
        <a href="{{ 'publications' | relative_url }}">(view all <i class="fas fa-angle-double-right"></i>)</a>
    </h6>
    {% for item in all_pubs limit:include.limit %}
        {% include widgets/publication_item.html item=item %}    
    {% endfor %}
</div>

